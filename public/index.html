<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
		/>
		<title>Zenith | AC</title>
		<link rel="shortcut icon" href="Zenith.png" />
	
		<script src="/scram/scramjet.all.js"></script>
		<script src="/baremux/index.js"></script>
		
		<link rel="stylesheet" href="index.css" />
		<script src="register-sw.js" defer></script>
		<script src="search.js" defer></script>
		<script src="index.js" defer></script>
		
		<style>
			/* Black background theme */
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}
			
			body {
				background-color: #000 !important;
				color: white !important;
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
				min-height: 100vh;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				padding: 40px 20px;
				overflow: hidden;
				position: relative;
			}
			
			/* Epic animated background with multiple layers */
			body::before {
				content: '';
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: 
					radial-gradient(circle at 30% 50%, rgba(138, 43, 226, 0.15) 0%, transparent 50%),
					radial-gradient(circle at 70% 50%, rgba(0, 191, 255, 0.15) 0%, transparent 50%),
					radial-gradient(circle at 50% 30%, rgba(255, 0, 255, 0.1) 0%, transparent 50%);
				z-index: -3;
			}
			
			/* Animated wave pattern background */
			body::after {
				content: '';
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: 
					repeating-linear-gradient(
						0deg,
						transparent,
						transparent 2px,
						rgba(0, 191, 255, 0.03) 2px,
						rgba(0, 191, 255, 0.03) 4px
					),
					repeating-linear-gradient(
						90deg,
						transparent,
						transparent 2px,
						rgba(138, 43, 226, 0.03) 2px,
						rgba(138, 43, 226, 0.03) 4px
					);
				background-size: 100px 100px;
				animation: waveMove 15s linear infinite;
				z-index: -2;
				opacity: 0.5;
			}
			
			/* Floating hexagonal shapes */
			.bg-shape {
				position: fixed;
				width: 100px;
				height: 115px;
				border: 2px solid;
				opacity: 0.15;
				animation: floatShape 25s ease-in-out infinite;
				z-index: -1;
				clip-path: polygon(30% 0%, 70% 0%, 100% 50%, 70% 100%, 30% 100%, 0% 50%);
			}
			
			.bg-shape:nth-child(1) {
				width: 200px;
				height: 230px;
				border-color: #00bfff;
				top: 15%;
				left: 10%;
				animation-delay: 0s;
				animation-duration: 20s;
				filter: blur(1px);
			}
			
			.bg-shape:nth-child(2) {
				width: 150px;
				height: 172px;
				border-color: #8a2be2;
				top: 50%;
				right: 15%;
				animation-delay: -8s;
				animation-duration: 25s;
				filter: blur(1px);
			}
			
			.bg-shape:nth-child(3) {
				width: 120px;
				height: 138px;
				border-color: #ff00ff;
				bottom: 20%;
				left: 25%;
				animation-delay: -15s;
				animation-duration: 30s;
				filter: blur(1px);
			}
			
			.bg-shape:nth-child(4) {
				width: 180px;
				height: 207px;
				border-color: #00ffff;
				top: 30%;
				right: 35%;
				animation-delay: -5s;
				animation-duration: 22s;
				filter: blur(1px);
			}
			
			@keyframes waveMove {
				0% { 
					background-position: 0 0, 0 0;
					opacity: 0.3;
				}
				50% {
					opacity: 0.6;
				}
				100% { 
					background-position: 100px 100px, -100px -100px;
					opacity: 0.3;
				}
			}
			
			@keyframes floatShape {
				0%, 100% { 
					transform: translate(0, 0) rotate(0deg) scale(1);
					opacity: 0.15;
				}
				25% { 
					transform: translate(40px, -40px) rotate(90deg) scale(1.1);
					opacity: 0.2;
				}
				50% { 
					transform: translate(-30px, -80px) rotate(180deg) scale(0.9);
					opacity: 0.12;
				}
				75% { 
					transform: translate(-50px, -40px) rotate(270deg) scale(1.05);
					opacity: 0.18;
				}
			}
			
			@keyframes glow {
				0%, 100% { 
					text-shadow: 
						0 0 10px rgba(0, 191, 255, 0.8),
						0 0 20px rgba(0, 191, 255, 0.6),
						0 0 30px rgba(138, 43, 226, 0.4);
				}
				50% { 
					text-shadow: 
						0 0 20px rgba(0, 191, 255, 1),
						0 0 30px rgba(0, 191, 255, 0.8),
						0 0 40px rgba(138, 43, 226, 0.6),
						0 0 50px rgba(255, 0, 255, 0.4);
				}
			}
			
			@keyframes floatLogo {
				0%, 100% { 
					transform: translateY(0px) rotate(0deg);
				}
				25% {
					transform: translateY(-15px) rotate(2deg);
				}
				50% { 
					transform: translateY(-25px) rotate(0deg);
				}
				75% {
					transform: translateY(-15px) rotate(-2deg);
				}
			}
			
			/* Particle effects - falling and rising */
			.particle {
				position: fixed;
				width: 4px;
				height: 4px;
				background: #00bfff;
				border-radius: 50%;
				pointer-events: none;
				z-index: -1;
				box-shadow: 0 0 10px rgba(0, 191, 255, 0.8);
			}
			
			.particle.fall {
				animation: particle-fall linear infinite;
			}
			
			.particle.rise {
				animation: particle-rise linear infinite;
			}
			
			@keyframes particle-fall {
				0% {
					transform: translateY(-100vh) translateX(0) rotate(0deg);
					opacity: 0;
				}
				10% {
					opacity: 1;
				}
				90% {
					opacity: 1;
				}
				100% {
					transform: translateY(100vh) translateX(-30px) rotate(360deg);
					opacity: 0;
				}
			}
			
			@keyframes particle-rise {
				0% {
					transform: translateY(100vh) translateX(0) rotate(0deg);
					opacity: 0;
				}
				10% {
					opacity: 1;
				}
				90% {
					opacity: 1;
				}
				100% {
					transform: translateY(-100vh) translateX(50px) rotate(-360deg);
					opacity: 0;
				}
			}
			
			/* Make sure everything centers properly */
			.logo-wrapper {
				text-align: center;
				margin-bottom: 30px;
				width: 100%;
			}
			
			.logo-wrapper .logo {
				width: 150px;
				height: auto;
				display: block;
				margin: 0 auto 20px auto;
				animation: floatLogo 6s ease-in-out infinite;
				filter: drop-shadow(0 0 30px rgba(0, 191, 255, 0.8)) drop-shadow(0 0 60px rgba(138, 43, 226, 0.4));
			}
			
			.logo-wrapper h1 {
				color: white;
				font-size: 3rem;
				letter-spacing: 5px;
				margin-top: 10px;
				animation: glow 4s ease-in-out infinite;
			}
			
			.desc {
				text-align: center;
				max-width: 600px;
				margin: 20px auto;
			}
			
			.desc p {
				color: #ccc;
				font-size: 14px;
				line-height: 1.6;
			}
			
			#sj-form {
				width: 100%;
				display: flex;
				justify-content: center;
				margin: 30px 0;
			}
			
			#sj-address {
				width: 500px;
				max-width: 90%;
				background: #0a0a0a;
				border: 1px solid #333;
				color: white;
				padding: 15px 25px;
				border-radius: 30px;
				font-size: 18px;
			}
			
			#sj-address:focus {
				border-color: #555;
				outline: none;
			}
			
			#sj-error, #sj-error-code {
				color: #ff6b6b;
				text-align: center;
			}
			
			footer {
				color: #666;
				text-align: center;
				margin-top: auto;
				padding: 20px;
				font-size: 12px;
			}
			
			footer a {
				color: #888;
				text-decoration: none;
			}
			
			footer a:hover {
				color: white;
			}
			
			/* Navbar styles */
			.zenith-navbar {
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				height: 45px;
				background: #0a0a0a;
				display: none; /* Hidden by default, shown when browsing */
				align-items: center;
				justify-content: space-between;
				padding: 0 20px;
				border-bottom: 1px solid #1a1a1a;
				z-index: 10000; /* Higher than iframe */
			}
			
			.zenith-navbar.visible {
				display: flex;
			}
			
			/* Tab system */
			.nav-tabs {
				display: flex;
				gap: 5px;
				flex: 1;
				max-width: 600px;
				overflow-x: auto;
				overflow-y: hidden;
				align-items: center;
			}
			
			.nav-tabs::-webkit-scrollbar {
				height: 0;
			}
			
			.nav-tab {
				background: #1a1a1a;
				border: 1px solid #2a2a2a;
				border-radius: 8px 8px 0 0;
				padding: 8px 15px;
				display: flex;
				align-items: center;
				gap: 8px;
				cursor: pointer;
				min-width: 150px;
				max-width: 200px;
				white-space: nowrap;
				overflow: hidden;
			}
			
			.nav-tab:hover {
				background: #2a2a2a;
			}
			
			.nav-tab.active {
				background: #2a2a2a;
				border-bottom-color: #2a2a2a;
			}
			
			.nav-tab-title {
				flex: 1;
				overflow: hidden;
				text-overflow: ellipsis;
				color: #ccc;
				font-size: 13px;
			}
			
			.nav-tab.active .nav-tab-title {
				color: white;
			}
			
			.nav-tab-close {
				background: transparent;
				border: none;
				color: #666;
				cursor: pointer;
				padding: 0;
				font-size: 16px;
				width: 16px;
				height: 16px;
				display: flex;
				align-items: center;
				justify-content: center;
			}
			
			.nav-tab-close:hover {
				color: white;
				background: #444;
				border-radius: 3px;
			}
			
			.nav-new-tab {
				background: transparent;
				border: none;
				color: #888;
				cursor: pointer;
				font-size: 20px;
				padding: 5px 10px;
			}
			
			.nav-new-tab:hover {
				color: white;
			}
			
			.nav-left { 
				display: flex; 
				align-items: center; 
				cursor: pointer; 
			}
			
			.nav-logo { 
				height: 25px; 
				margin-right: 10px; 
			}
			
			.nav-title { 
				font-weight: bold; 
				letter-spacing: 1px;
				color: white;
			}
			
			.nav-center { 
				flex-grow: 1; 
				display: flex; 
				justify-content: center; 
			}
			
			.nav-input {
				width: 400px;
				background: #151515;
				border: 1px solid #333;
				color: white;
				padding: 5px 15px;
				border-radius: 20px;
				outline: none;
			}
			
			.nav-input:focus {
				border-color: #555;
			}
			
			.nav-btn {
				background: transparent;
				border: none;
				color: #888;
				margin-left: 15px;
				cursor: pointer;
				font-size: 12px;
			}
			
			.nav-btn:hover { 
				color: white; 
			}
			
			/* Hamburger menu */
			.nav-menu-btn {
				background: transparent;
				border: none;
				color: #888;
				cursor: pointer;
				font-size: 20px;
				padding: 5px 10px;
				margin-left: 10px;
			}
			
			.nav-menu-btn:hover {
				color: white;
			}
			
			.nav-menu-dropdown {
				position: absolute;
				top: 45px;
				right: 20px;
				background: #1a1a1a;
				border: 1px solid #333;
				border-radius: 8px;
				padding: 8px 0;
				min-width: 220px;
				display: none;
				z-index: 10001;
			}
			
			.nav-menu-dropdown.show {
				display: block;
			}
			
			.nav-menu-item {
				display: flex;
				align-items: center;
				padding: 12px 16px;
				color: #ccc;
				cursor: pointer;
				font-size: 14px;
				border: none;
				background: transparent;
				width: 100%;
				text-align: left;
			}
			
			.nav-menu-item:hover {
				background: #2a2a2a;
				color: white;
			}
			
			.nav-menu-item svg {
				margin-right: 12px;
				width: 18px;
				height: 18px;
			}
			
			.nav-menu-separator {
				height: 1px;
				background: #333;
				margin: 4px 0;
			}
			
			/* Light mode styles */
			body.light-mode {
				background-color: #f5f5f5 !important;
				color: #000 !important;
			}
			
			body.light-mode .zenith-navbar {
				background: #fff;
				border-bottom: 1px solid #e0e0e0;
			}
			
			body.light-mode .nav-title,
			body.light-mode .nav-btn,
			body.light-mode .nav-menu-btn {
				color: #333;
			}
			
			body.light-mode .nav-input {
				background: #f0f0f0;
				border-color: #ddd;
				color: #000;
			}
			
			body.light-mode #sj-address {
				background: #f0f0f0;
				border-color: #ddd;
				color: #000;
			}
			
			body.light-mode .desc p {
				color: #555;
			}
			
			body.light-mode .nav-menu-dropdown {
				background: #fff;
				border-color: #ddd;
			}
			
			body.light-mode .nav-menu-item {
				color: #333;
			}
			
			body.light-mode .nav-menu-item:hover {
				background: #f0f0f0;
			}
			
			/* Custom Inspect Element Modal */
			.inspect-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0,0,0,0.8);
				display: none;
				z-index: 10002;
				align-items: center;
				justify-content: center;
			}
			
			.inspect-modal.show {
				display: flex;
			}
			
			.inspect-content {
				background: #1a1a1a;
				border: 1px solid #333;
				border-radius: 8px;
				width: 90%;
				height: 80%;
				display: flex;
				flex-direction: column;
			}
			
			.inspect-header {
				padding: 15px 20px;
				border-bottom: 1px solid #333;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}
			
			.inspect-header h3 {
				color: white;
				margin: 0;
			}
			
			.inspect-close {
				background: transparent;
				border: none;
				color: #888;
				font-size: 24px;
				cursor: pointer;
			}
			
			.inspect-close:hover {
				color: white;
			}
			
			.inspect-body {
				flex: 1;
				overflow: auto;
				padding: 20px;
				background: #242424;
			}
			
			.inspect-tree {
				font-family: 'Courier New', monospace;
				font-size: 12px;
				line-height: 1.6;
			}
			
			.inspect-element {
				margin-left: 20px;
			}
			
			.inspect-tag {
				color: #e06c75;
			}
			
			.inspect-attr-name {
				color: #d19a66;
			}
			
			.inspect-attr-value {
				color: #98c379;
			}
			
			.inspect-text {
				color: #abb2bf;
			}
			
			.inspect-toggle {
				cursor: pointer;
				user-select: none;
				color: #61afef;
				display: inline-block;
				width: 12px;
			}
			
			.inspect-children {
				display: block;
			}
			
			.inspect-children.collapsed {
				display: none;
			}
			
			/* Settings Modal */
			.settings-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0,0,0,0.8);
				display: none;
				z-index: 10002;
				align-items: center;
				justify-content: center;
			}
			
			.settings-modal.show {
				display: flex;
			}
			
			.settings-content {
				background: #1a1a1a;
				border: 1px solid #333;
				border-radius: 8px;
				width: 600px;
				max-width: 90%;
				max-height: 80%;
				display: flex;
				flex-direction: column;
			}
			
			.settings-header {
				padding: 20px;
				border-bottom: 1px solid #333;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}
			
			.settings-header h2 {
				color: white;
				margin: 0;
			}
			
			.settings-close {
				background: transparent;
				border: none;
				color: #888;
				font-size: 24px;
				cursor: pointer;
			}
			
			.settings-close:hover {
				color: white;
			}
			
			.settings-body {
				flex: 1;
				overflow: auto;
				padding: 20px;
			}
			
			.settings-section {
				margin-bottom: 30px;
			}
			
			.settings-section h3 {
				color: white;
				font-size: 16px;
				margin-bottom: 15px;
			}
			
			.settings-option {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 12px 0;
				border-bottom: 1px solid #2a2a2a;
			}
			
			.settings-option:last-child {
				border-bottom: none;
			}
			
			.settings-label {
				color: #ccc;
				font-size: 14px;
			}
			
			.settings-toggle {
				width: 50px;
				height: 26px;
				background: #333;
				border-radius: 13px;
				position: relative;
				cursor: pointer;
				transition: background 0.3s;
			}
			
			.settings-toggle.active {
				background: #4CAF50;
			}
			
			.settings-toggle-slider {
				width: 22px;
				height: 22px;
				background: white;
				border-radius: 50%;
				position: absolute;
				top: 2px;
				left: 2px;
				transition: left 0.3s;
			}
			
			.settings-toggle.active .settings-toggle-slider {
				left: 26px;
			}
			
			.settings-input {
				background: #0a0a0a;
				border: 1px solid #333;
				border-radius: 4px;
				padding: 8px 12px;
				color: white;
				font-size: 14px;
				width: 200px;
			}
			
			/* Adjust iframe when navbar is visible */
			#sj-frame {
				position: fixed !important;
				top: 0 !important;
				left: 0 !important;
				width: 100% !important;
				height: 100vh !important;
				border: none !important;
				z-index: 9000 !important; /* Below navbar */
			}
			
			body.browsing #sj-frame {
				top: 45px !important;
				height: calc(100vh - 45px) !important;
			}
		</style>
	</head>
	<body>
		<!-- Background geometric shapes -->
		<div class="bg-shape"></div>
		<div class="bg-shape"></div>
		<div class="bg-shape"></div>
		<div class="bg-shape"></div>
		
		<!-- Navbar (hidden by default, shows when browsing) -->
		<nav class="zenith-navbar" id="zenith-navbar">
			<div class="nav-left" onclick="window.zenithGoHome()">
				<img src="Zenith.png" class="nav-logo" alt="Zenith">
				<span class="nav-title">ZENITH</span>
			</div>
			
			<!-- Tab system -->
			<div class="nav-tabs" id="nav-tabs">
				<!-- Tabs will be added dynamically -->
			</div>
			<button class="nav-new-tab" onclick="window.addNewTab()" title="New tab">+</button>
			
			<div class="nav-right">
				<button onclick="window.zenithGoHome()" class="nav-btn" type="button">üè† HOME</button>
				<button onclick="window.toggleNavMenu()" class="nav-menu-btn" type="button">‚ò∞</button>
			</div>
			
			<!-- Dropdown menu -->
			<div id="nav-menu-dropdown" class="nav-menu-dropdown">
				<button class="nav-menu-item" onclick="window.openNewTab()">
					<span>‚ûï New tab (Ctrl+Alt+N)</span>
				</button>
				<button class="nav-menu-item" onclick="window.toggleFullscreen()">
					<span>‚õ∂ Full Screen (Ctrl+Alt+Z)</span>
				</button>
				<button class="nav-menu-item" onclick="window.reloadPage()">
					<span>‚Üª Reload (Ctrl+Alt+R)</span>
				</button>
				<button class="nav-menu-item" onclick="window.inspectElement()">
					<span>‚öô Inspect Element (Ctrl+Alt+I)</span>
				</button>
				<div class="nav-menu-separator"></div>
				<button class="nav-menu-item" onclick="window.toggleDarkMode()">
					<span>üåô Dark Mode (Ctrl+Alt+X)</span>
				</button>
				<button class="nav-menu-item" onclick="window.toggleAboutBlank()">
					<span>üîí AB Cloak (Ctrl+Alt+C)</span>
				</button>
				<button class="nav-menu-item" onclick="window.panicMode()">
					<span>‚ö† Panic ()</span>
				</button>
				<div class="nav-menu-separator"></div>
				<button class="nav-menu-item" onclick="window.openSettings()">
					<span>‚öô Settings (Ctrl+.)</span>
				</button>
			</div>
		</nav>
	
		<div style="width: 100%; max-width: 800px; margin: auto;">
			<div class="logo-wrapper">
				<img class="logo" src="Zenith.png" alt="Zenith" />
				<h1>ZENITH | AC</h1>
			</div>
			<div class="desc">
				<p>
					Zenith is a newly designed web Pr0xy designed to
					evade internet censorship, bypass arbitrary web browser restrictions and
					innovate web proxy technologies. Using this proxy, if you ever get caught 
					using it will not be responsible. Keep this in mind when browsing. More g@mes,
					@pps, and more will be added soon as Zenith improves. Stay
					safe and have fun everyone.
				</p>
			</div>
			<form id="sj-form">
				<input
					id="sj-search-engine"
					value="https://www.google.com/search?q=%s"
					type="hidden"
				/>
				<input id="sj-address" type="text" placeholder="Explore the web freely..." />
			</form>
			<div class="desc">
				<p id="sj-error"></p>
				<pre id="sj-error-code"></pre>
			</div>
		</div>
		
		<!-- Custom Inspect Element Modal -->
		<div id="inspect-modal" class="inspect-modal">
			<div class="inspect-content">
				<div class="inspect-header">
					<h3>üîç Inspect Element</h3>
					<button class="inspect-close" onclick="window.closeInspect()">√ó</button>
				</div>
				<div class="inspect-body">
					<div class="inspect-tree" id="inspect-tree"></div>
				</div>
			</div>
		</div>
		
		<!-- Settings Modal -->
		<div id="settings-modal" class="settings-modal">
			<div class="settings-content">
				<div class="settings-header">
					<h2>‚öôÔ∏è Settings</h2>
					<button class="settings-close" onclick="window.closeSettings()">√ó</button>
				</div>
				<div class="settings-body">
					<div class="settings-section">
						<h3>Appearance</h3>
						<div class="settings-option">
							<span class="settings-label">Dark Mode</span>
							<div class="settings-toggle active" id="dark-mode-toggle" onclick="window.toggleDarkMode()">
								<div class="settings-toggle-slider"></div>
							</div>
						</div>
					</div>
					
					<div class="settings-section">
						<h3>Search Engine</h3>
						<div class="settings-option">
							<span class="settings-label">Default Search</span>
							<select class="settings-input" id="search-engine-select">
								<option value="https://www.google.com/search?q=%s">Google</option>
								<option value="https://www.bing.com/search?q=%s">Bing</option>
								<option value="https://duckduckgo.com/?q=%s">DuckDuckGo</option>
								<option value="https://search.brave.com/search?q=%s">Brave</option>
							</select>
						</div>
					</div>
					
					<div class="settings-section">
						<h3>Privacy</h3>
						<div class="settings-option">
							<span class="settings-label">About:Blank Cloaking</span>
							<div class="settings-toggle" id="ab-cloak-toggle" onclick="window.toggleAbCloak()">
								<div class="settings-toggle-slider"></div>
							</div>
						</div>
						<div class="settings-option">
							<span class="settings-label">Panic URL</span>
							<input type="text" class="settings-input" id="panic-url" value="https://www.google.com" placeholder="https://...">
						</div>
					</div>
					
					<div class="settings-section">
						<h3>Advanced</h3>
						<div class="settings-option">
							<span class="settings-label">Custom Tab Title</span>
							<input type="text" class="settings-input" id="tab-title" placeholder="Zenith | AC">
						</div>
						<div class="settings-option">
							<span class="settings-label">Custom Favicon URL</span>
							<input type="text" class="settings-input" id="favicon-url" placeholder="https://...">
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<footer>
			<div>
				<span>Zenith &copy; 2026</span>
			</div>
		</footer>
		
		<script>
			// Tab management system
			let tabs = [];
			let activeTabId = null;
			let tabIdCounter = 0;
			
			function createTab(url, title) {
				const tabId = ++tabIdCounter;
				const tab = {
					id: tabId,
					url: url,
					title: title || 'New Tab',
					iframe: null
				};
				tabs.push(tab);
				
				// Create iframe for this tab
				const iframe = document.createElement('iframe');
				iframe.id = 'tab-frame-' + tabId;
				iframe.style.cssText = 'position:fixed;top:45px;left:0;width:100%;height:calc(100vh - 45px);border:none;z-index:9000;display:none;';
				iframe.src = url;
				document.body.appendChild(iframe);
				tab.iframe = iframe;
				
				// Update tab title when page loads
				iframe.onload = function() {
					try {
						const pageTitle = iframe.contentWindow.document.title;
						if (pageTitle) {
							tab.title = pageTitle;
							renderTabs();
						}
					} catch(e) {
						// Cross-origin, can't get title
					}
				};
				
				renderTabs();
				switchToTab(tabId);
				return tab;
			}
			
			function switchToTab(tabId) {
				activeTabId = tabId;
				
				// Hide all iframes
				tabs.forEach(tab => {
					if (tab.iframe) {
						tab.iframe.style.display = 'none';
					}
				});
				
				// Show active iframe
				const activeTab = tabs.find(t => t.id === tabId);
				if (activeTab && activeTab.iframe) {
					activeTab.iframe.style.display = 'block';
				}
				
				renderTabs();
			}
			
			function closeTab(tabId) {
				const tabIndex = tabs.findIndex(t => t.id === tabId);
				if (tabIndex === -1) return;
				
				const tab = tabs[tabIndex];
				if (tab.iframe) {
					tab.iframe.remove();
				}
				
				tabs.splice(tabIndex, 1);
				
				if (tabs.length === 0) {
					window.zenithGoHome();
				} else if (activeTabId === tabId) {
					// Switch to next tab or previous
					const newActiveTab = tabs[tabIndex] || tabs[tabIndex - 1];
					switchToTab(newActiveTab.id);
				} else {
					renderTabs();
				}
			}
			
			function renderTabs() {
				const tabsContainer = document.getElementById('nav-tabs');
				tabsContainer.innerHTML = '';
				
				tabs.forEach(tab => {
					const tabEl = document.createElement('div');
					tabEl.className = 'nav-tab' + (tab.id === activeTabId ? ' active' : '');
					tabEl.innerHTML = `
						<span class="nav-tab-title">${tab.title}</span>
						<button class="nav-tab-close" onclick="event.stopPropagation(); window.closeTab(${tab.id})">√ó</button>
					`;
					tabEl.onclick = () => switchToTab(tab.id);
					tabsContainer.appendChild(tabEl);
				});
			}
			
			window.addNewTab = function() {
				createTab('/service/' + encodeURIComponent('https://www.google.com'), 'Google');
			};
			
			window.closeTab = closeTab;
			
			// Navbar functionality - doesn't interfere with Scramjet
			window.zenithNavSearch = function(event) {
				event.preventDefault();
				const navInput = document.getElementById('nav-address');
				const mainInput = document.getElementById('sj-address');
				if (navInput.value && mainInput) {
					mainInput.value = navInput.value;
					document.getElementById('sj-form').dispatchEvent(new Event('submit', { bubbles: true, cancelable: true }));
				}
				return false;
			};
			
			window.zenithGoHome = function() {
				// Close all tabs
				tabs.forEach(tab => {
					if (tab.iframe) tab.iframe.remove();
				});
				tabs = [];
				activeTabId = null;
				renderTabs();
				
				// Hide navbar and show home
				const navbar = document.getElementById('zenith-navbar');
				const homeContent = document.querySelector('body > div[style*="max-width"]');
				const footer = document.querySelector('footer');
				
				if (navbar) navbar.style.display = 'none';
				if (homeContent) homeContent.style.display = 'block';
				if (footer) footer.style.display = 'block';
				
				document.body.classList.remove('browsing');
			};
			
			// Override the main search form to create tabs
			document.addEventListener('DOMContentLoaded', () => {
				const mainForm = document.getElementById('sj-form');
				if (mainForm) {
					mainForm.addEventListener('submit', (e) => {
						e.preventDefault();
						const input = document.getElementById('sj-address');
						if (!input.value.trim()) return;
						
						let url = input.value.trim();
						if (!url.includes('.') || url.includes(' ')) {
							const searchEngine = document.getElementById('sj-search-engine')?.value || 'https://www.google.com/search?q=%s';
							url = searchEngine.replace('%s', encodeURIComponent(url));
						} else if (!url.startsWith('http')) {
							url = 'https://' + url;
						}
						
						// Create tab
						createTab('/service/' + encodeURIComponent(url), url);
						
						// Show navbar
						const navbar = document.getElementById('zenith-navbar');
						const homeContent = document.querySelector('body > div[style*="max-width"]');
						const footer = document.querySelector('footer');
						
						if (navbar) navbar.style.display = 'flex';
						if (homeContent) homeContent.style.display = 'none';
						if (footer) footer.style.display = 'none';
						
						document.body.classList.add('browsing');
					});
				}
			});
			
			// Toggle hamburger menu
			window.toggleNavMenu = function() {
				const dropdown = document.getElementById('nav-menu-dropdown');
				dropdown.classList.toggle('show');
			};
			
			// Close menu when clicking outside
			document.addEventListener('click', function(event) {
				const dropdown = document.getElementById('nav-menu-dropdown');
				const menuBtn = event.target.closest('.nav-menu-btn');
				if (!menuBtn && !event.target.closest('.nav-menu-dropdown')) {
					dropdown.classList.remove('show');
				}
			});
			
			// Menu functions (basic implementations)
			window.openNewTab = function() {
				addNewTab();
			};
			
			window.toggleFullscreen = function() {
				if (!document.fullscreenElement) {
					document.documentElement.requestFullscreen();
				} else {
					document.exitFullscreen();
				}
			};
			
			window.reloadPage = function() {
				const frame = document.getElementById('sj-frame');
				if (frame && frame.src) {
					frame.src = frame.src;
				}
			};
			
			// Custom Inspect Element - Chrome DevTools style
			window.inspectElement = function() {
				const modal = document.getElementById('inspect-modal');
				const treeEl = document.getElementById('inspect-tree');
				const frame = document.getElementById('sj-frame');
				
				if (frame && frame.contentWindow) {
					try {
						const doc = frame.contentWindow.document.documentElement;
						treeEl.innerHTML = renderElement(doc, 0);
					} catch(e) {
						treeEl.innerHTML = '<div style="color:#e06c75;">Cannot inspect: Cross-origin frame<br><br>Error: ' + e.message + '</div>';
					}
				} else {
					treeEl.innerHTML = '<div style="color:#61afef;"><!-- No page loaded --></div>';
				}
				
				modal.classList.add('show');
			};
			
			function renderElement(el, depth) {
				if (!el) return '';
				
				const tagName = el.tagName?.toLowerCase();
				if (!tagName) return '';
				
				const attrs = Array.from(el.attributes || [])
					.map(attr => `<span class="inspect-attr-name">${attr.name}</span>=<span class="inspect-attr-value">"${attr.value}"</span>`)
					.join(' ');
				
				const hasChildren = el.children.length > 0;
				const toggleId = 'toggle-' + Math.random().toString(36).substr(2, 9);
				
				let html = '<div class="inspect-element">';
				
				if (hasChildren) {
					html += `<span class="inspect-toggle" onclick="window.toggleInspectNode('${toggleId}')">‚ñº</span> `;
				} else {
					html += '<span class="inspect-toggle" style="visibility:hidden;">‚ñº</span> ';
				}
				
				html += `<span class="inspect-tag">&lt;${tagName}</span>`;
				if (attrs) html += ` ${attrs}`;
				html += `<span class="inspect-tag">&gt;</span>`;
				
				if (hasChildren) {
					html += `<div id="${toggleId}" class="inspect-children">`;
					for (let child of el.children) {
						html += renderElement(child, depth + 1);
					}
					html += `</div><span class="inspect-tag">&lt;/${tagName}&gt;</span>`;
				} else if (el.textContent && el.textContent.trim()) {
					const text = el.textContent.trim().substring(0, 50);
					html += `<span class="inspect-text">${text}${el.textContent.length > 50 ? '...' : ''}</span>`;
					html += `<span class="inspect-tag">&lt;/${tagName}&gt;</span>`;
				} else {
					html += `<span class="inspect-tag">&lt;/${tagName}&gt;</span>`;
				}
				
				html += '</div>';
				return html;
			}
			
			window.toggleInspectNode = function(id) {
				const el = document.getElementById(id);
				if (el) {
					el.classList.toggle('collapsed');
					const toggle = el.previousElementSibling;
					if (toggle && toggle.classList.contains('inspect-toggle')) {
						toggle.textContent = el.classList.contains('collapsed') ? '‚ñ∂' : '‚ñº';
					}
				}
			};
			
			window.closeInspect = function() {
				document.getElementById('inspect-modal').classList.remove('show');
			};
			
			// Dark/Light Mode Toggle
			window.toggleDarkMode = function() {
				const body = document.body;
				const toggle = document.getElementById('dark-mode-toggle');
				
				body.classList.toggle('light-mode');
				toggle.classList.toggle('active');
				
				// Change iframe background and inject styles
				const frame = document.getElementById('sj-frame');
				if (frame) {
					const isLightMode = body.classList.contains('light-mode');
					
					if (isLightMode) {
						frame.style.background = 'white';
					} else {
						frame.style.background = '#1a1a1a';
					}
					
					// Try to inject dark mode styles into the iframe
					try {
						const iframeDoc = frame.contentWindow.document;
						let styleEl = iframeDoc.getElementById('zenith-dark-mode');
						
						if (!isLightMode && !styleEl) {
							// Add dark mode styles
							styleEl = iframeDoc.createElement('style');
							styleEl.id = 'zenith-dark-mode';
							styleEl.textContent = `
								body { background-color: #1a1a1a !important; color: #e0e0e0 !important; }
								* { background-color: inherit; }
								input, textarea, select { background-color: #2a2a2a !important; color: white !important; border-color: #444 !important; }
								a { color: #4d9fff !important; }
							`;
							iframeDoc.head.appendChild(styleEl);
						} else if (isLightMode && styleEl) {
							// Remove dark mode styles
							styleEl.remove();
						}
					} catch(e) {
						// Cross-origin iframe, can't inject styles
						console.log('Cannot inject styles into cross-origin iframe');
					}
				}
				
				// Save preference
				localStorage.setItem('zenith-theme', body.classList.contains('light-mode') ? 'light' : 'dark');
			};
			
			// Load saved theme on startup
			window.addEventListener('load', function() {
				const savedTheme = localStorage.getItem('zenith-theme');
				if (savedTheme === 'light') {
					document.body.classList.add('light-mode');
					const toggle = document.getElementById('dark-mode-toggle');
					if (toggle) toggle.classList.remove('active');
				}
			});
			
			// About:Blank Cloaking
			let abCloakEnabled = localStorage.getItem('ab-cloak') === 'true';
			
			window.toggleAbCloak = function() {
				abCloakEnabled = !abCloakEnabled;
				localStorage.setItem('ab-cloak', abCloakEnabled);
				const toggle = document.getElementById('ab-cloak-toggle');
				if (toggle) {
					toggle.classList.toggle('active', abCloakEnabled);
				}
				
				if (abCloakEnabled) {
					window.toggleAboutBlank();
				}
			};
			
			window.toggleAboutBlank = function() {
				const win = window.open();
				win.document.body.innerHTML = `<iframe src="${window.location.href}" style="position:fixed;top:0;left:0;width:100%;height:100%;border:none;"></iframe>`;
				window.close();
			};
			
			window.panicMode = function() {
				const panicUrl = document.getElementById('panic-url')?.value || 'https://www.google.com';
				window.location.href = panicUrl;
			};
			
			// Settings Modal
			window.openSettings = function() {
				const modal = document.getElementById('settings-modal');
				modal.classList.add('show');
				
				// Load saved settings
				const searchEngine = localStorage.getItem('search-engine') || 'https://www.google.com/search?q=%s';
				const panicUrl = localStorage.getItem('panic-url') || 'https://www.google.com';
				const tabTitle = localStorage.getItem('tab-title') || '';
				const faviconUrl = localStorage.getItem('favicon-url') || '';
				
				document.getElementById('search-engine-select').value = searchEngine;
				document.getElementById('panic-url').value = panicUrl;
				document.getElementById('tab-title').value = tabTitle;
				document.getElementById('favicon-url').value = faviconUrl;
				
				const abToggle = document.getElementById('ab-cloak-toggle');
				if (abToggle) {
					abToggle.classList.toggle('active', abCloakEnabled);
				}
			};
			
			window.closeSettings = function() {
				document.getElementById('settings-modal').classList.remove('show');
				
				// Save settings
				localStorage.setItem('search-engine', document.getElementById('search-engine-select').value);
				localStorage.setItem('panic-url', document.getElementById('panic-url').value);
				localStorage.setItem('tab-title', document.getElementById('tab-title').value);
				localStorage.setItem('favicon-url', document.getElementById('favicon-url').value);
				
				// Apply settings
				const tabTitle = document.getElementById('tab-title').value;
				if (tabTitle) document.title = tabTitle;
				
				const faviconUrl = document.getElementById('favicon-url').value;
				if (faviconUrl) {
					const link = document.querySelector("link[rel*='icon']") || document.createElement('link');
					link.type = 'image/x-icon';
					link.rel = 'shortcut icon';
					link.href = faviconUrl;
					document.getElementsByTagName('head')[0].appendChild(link);
				}
				
				// Update search engine
				const searchEngine = document.getElementById('search-engine-select').value;
				const searchInput = document.getElementById('sj-search-engine');
				if (searchInput) searchInput.value = searchEngine;
			};
			
			// Show navbar when iframe becomes visible, hide home content
			function updateUIState() {
				const frame = document.getElementById('sj-frame');
				const navbar = document.getElementById('zenith-navbar');
				const homeContent = document.querySelector('body > div[style*="max-width"]');
				const footer = document.querySelector('footer');
				
				if (frame && navbar) {
					// Check if iframe is visible and has content
					const isBrowsing = frame.style.display === 'block' || (frame.style.display !== 'none' && frame.src);
					
					if (isBrowsing) {
						// Browsing mode: show navbar, hide home content
						navbar.classList.add('visible');
						navbar.style.display = 'flex';
						document.body.classList.add('browsing');
						if (homeContent) homeContent.style.display = 'none';
						if (footer) footer.style.display = 'none';
						console.log('Navbar shown - browsing mode');
					} else {
						// Home mode: hide navbar, show home content
						navbar.classList.remove('visible');
						navbar.style.display = 'none';
						document.body.classList.remove('browsing');
						if (homeContent) homeContent.style.display = 'block';
						if (footer) footer.style.display = 'block';
						console.log('Navbar hidden - home mode');
					}
				}
			}
			
			const observer = new MutationObserver(updateUIState);
			
			// Start observing once the iframe exists
			window.addEventListener('load', () => {
				const frame = document.getElementById('sj-frame');
				if (frame) {
					observer.observe(frame, { attributes: true, attributeFilter: ['style', 'src'] });
					// Also check immediately
					updateUIState();
				}
				
				// Check periodically in case the mutation observer misses something
				setInterval(updateUIState, 500);
				
				// Generate particles
				createParticles();
			});
			
			// Create animated particles - mix of falling and rising
			function createParticles() {
				const particleCount = 40; // More particles for better effect
				for (let i = 0; i < particleCount; i++) {
					setTimeout(() => {
						const particle = document.createElement('div');
						particle.className = 'particle';
						
						// Randomly make particles fall or rise
						if (Math.random() > 0.5) {
							particle.classList.add('fall');
						} else {
							particle.classList.add('rise');
						}
						
						particle.style.left = Math.random() * 100 + '%';
						particle.style.animationDuration = (Math.random() * 8 + 12) + 's';
						particle.style.animationDelay = Math.random() * 5 + 's';
						
						// Random colors with different sizes
						const colors = ['#00bfff', '#8a2be2', '#ff00ff', '#00ffff'];
						const sizes = [3, 4, 5];
						const size = sizes[Math.floor(Math.random() * sizes.length)];
						
						particle.style.background = colors[Math.floor(Math.random() * colors.length)];
						particle.style.boxShadow = `0 0 ${size * 3}px ${particle.style.background}`;
						particle.style.width = size + 'px';
						particle.style.height = size + 'px';
						
						document.body.appendChild(particle);
					}, i * 300);
				}
			}
		</script>
	</body>
</html>
